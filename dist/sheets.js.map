{"version":3,"sources":["webpack:///webpack/bootstrap b9f62d8887a9fc196cd0","webpack:///./src/Sheet.js","webpack:///./src/Context.js","webpack:///./src/Row.js","webpack:///./src/ScreenComponent.js","webpack:///./src/RowHeader.js","webpack:///./src/Cell.js","webpack:///./src/constants.js","webpack:///./src/util.js","webpack:///./src/ColumnHeaderRow.js","webpack:///./src/ColumnHeader.js"],"names":["Sheet","target","options","scrollY","scrollX","selectMinRowIndex","selectMaxRowIndex","selectMinColIndex","selectMaxColIndex","Object","assign","width","undefined","height","rowCount","colCount","context","onMouseMove","mouseMove","bind","onMouseDown","mouseDown","onMouseUp","mouseUp","onMouseClick","mouseClick","onScroll","scroll","columnHeaderRow","rows","rowY","i","push","mainLoop","draw","requestAnimationFrame","x","y","isCollision","length","document","body","style","cursor","dx","dy","drawRect","borderColor","borderWidth","fillColor","row","isVisibleOnScreen","showMultiSelect","minRow","maxRow","cells","rowIndex","delta","colIndex","newWidth","resizeCol","deselectAllCells","clearMultiSelect","isMultiSelecting","updateSelection","getCell","Context","ctx","getContext","scale","self","getMouseCoords","e","rect","canvas","getBoundingClientRect","clientX","left","clientY","top","onmousemove","coords","preventDefault","onmousedown","onmouseup","onclick","onmousewheel","deltaX","deltaY","points","color","cap","lineJoin","beginPath","moveTo","lineTo","lineWidth","strokeStyle","lineCap","stroke","fillStyle","fill","text","font","align","baseLine","textAlign","textBaseline","fillText","img","drawImage","clearRect","Row","index","sheet","rowHeader","backGroundColor","cellX","cell","oldWidth","repaint","blur","minColIndex","maxColIndex","isSelected","ScreenComponent","canvasX","canvasY","RowHeader","textBufferCanvas","createElement","textBufferContext","updateText","Cell","dependentCells","value","getIndividualArgValue","arg","test","colAlpha","colAlphaMatch","col","match","indexOf","functionName","substr","split","args","replace","argValues","trim","rangeIndexes","j","result","formulajs","apply","isTextBufferInitialized","isNumeric","clear","drawText","isEditing","inputElement","hide","show","css","focus","updateValue","val","remove","startMultiSelect","multiSelectSize","edit","endMultiSelect","$","type","id","append","dirty","keydown","keyCode","which","shiftKey","keyup","pastedData","originalEvent","clipboardData","getData","ROW_HEADER_WIDTH","CELL_WIDTH","CELL_HEIGHT","alpha","iToA","current","a","digit","Math","floor","aToI","pow","ColumnHeaderRow","columnHeaders","headerX","columnHeader","isResizing","xDelta","resizeStartX","resizeHeader","resizeStartWidth","ColumnHeader"],"mappings":"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","file":"sheets.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap b9f62d8887a9fc196cd0\n **/","import Context from './Context';\nimport Row from './Row';\nimport ColumnHeaderRow from './ColumnHeaderRow';\nimport {CELL_WIDTH, CELL_HEIGHT, ROW_HEADER_WIDTH} from './constants';\n\nclass Sheet {\n  constructor(target, options) {\n    this.scrollY = 0;\n    this.scrollX = 0;\n\n    this.selectMinRowIndex = -1;\n    this.selectMaxRowIndex = -1;\n    this.selectMinColIndex = -1;\n    this.selectMaxColIndex = -1;\n\n    Object.assign(this, {\n      width: undefined,\n      height: undefined,\n      rowCount: 2000,\n      colCount: 500,\n    }, options);\n\n    this.context = new Context(target, {\n        onMouseMove: this.mouseMove.bind(this),\n        onMouseDown: this.mouseDown.bind(this),\n        onMouseUp: this.mouseUp.bind(this),\n        onMouseClick: this.mouseClick.bind(this),\n        onScroll: this.scroll.bind(this),\n        width: this.width,\n        height: this.height\n    });\n\n    //TODO: make target a div and have library create canvas element\n    //TODO: allow to fill size of div placed in\n\n    //Column headerX\n    this.columnHeaderRow = new ColumnHeaderRow(this, 0, 0, this.rowCount);\n\n    //Data rows\n    this.rows = [];\n\n    let rowY = CELL_HEIGHT;\n\n    for(let i = 0; i < this.rowCount; i++) {\n      this.rows.push(new Row(i, this, 0, rowY, this.colCount));\n      rowY += CELL_HEIGHT;\n    }\n\n    this.mainLoop();\n  }\n\n  mainLoop() {\n    this.draw();\n    requestAnimationFrame(this.mainLoop.bind(this));\n  }\n\n  mouseDown(x, y) {\n    if(this.columnHeaderRow.isCollision(x, y)) {\n      this.columnHeaderRow.mouseDown(x, y);\n    }\n    else {\n      for(let i = 0; i < this.rows.length; i++) {\n        if(this.rows[i].isCollision(x, y)) {\n          this.rows[i].mouseDown(x, y);\n        }\n      }\n    }\n  }\n\n  mouseMove(x, y) {\n    document.body.style.cursor = 'default';\n\n    if(this.columnHeaderRow.isCollision(x, y)) {\n      this.columnHeaderRow.mouseMove(x, y);\n    }\n    else {\n      for(let i = 0; i < this.rows.length; i++) {\n        if(this.rows[i].isCollision(x, y)) {\n          this.rows[i].mouseMove(x, y);\n        }\n      }\n    }\n  }\n\n  mouseUp(x, y) {\n    if(this.columnHeaderRow.isCollision(x, y)) {\n      this.columnHeaderRow.mouseUp(x, y);\n    }\n    else {\n      for(let i = 0; i < this.rows.length; i++) {\n        if(this.rows[i].isCollision(x, y)) {\n          this.rows[i].mouseUp(x, y);\n        }\n      }\n    }\n  }\n\n  mouseClick(x, y) {\n    for(let i = 0; i < this.rows.length; i++) {\n      if(this.rows[i].isCollision(x, y)) {\n        this.rows[i].mouseClick(x, y);\n      }\n    }\n  }\n\n  scroll(dx, dy) {\n    if(dy > 0) {\n      this.scrollY -= 5 * dy;\n    }\n    else if(dy < 0) {\n      if(this.scrollY <= -5 * -dy) {\n        this.scrollY -= 5 * dy;\n      }\n    }\n\n    if(dx > 0) {\n      this.scrollX -= 5 * dx;\n    }\n    else if(dx < 0) {\n      if(this.scrollX <= -5 * -dx) {\n        this.scrollX -= 5 * dx;\n      }\n    }\n  }\n\n  draw() {\n    //Background and border\n    this.context.drawRect(0, 0, this.width, this.height, {\n      borderColor: 'darkGray',\n      borderWidth: 3,\n      fillColor: 'lightGray'\n    });\n\n    //Header\n\n    //Rows\n    for(let i = 0; i < this.rows.length; i++) {\n      const row = this.rows[i];\n\n      if(row.isVisibleOnScreen()) {\n        this.rows[i].draw();\n      }\n    }\n\n    //Column headers\n    this.columnHeaderRow.draw();\n    this.context.drawRect(0, 0, ROW_HEADER_WIDTH, CELL_HEIGHT, {\n      borderColor: 'black',\n      borderWidth: 1,\n      fillColor: 'darkGray'\n    });\n\n    //Scroll bars\n\n    //Multiselect borderWidth\n    if(this.showMultiSelect) {\n      let minRow = this.rows[this.selectMinRowIndex];\n      let maxRow = this.rows[this.selectMaxRowIndex];\n\n      let x = minRow.cells[this.selectMinColIndex].x + this.scrollX;\n      let y = minRow.y + this.scrollY;\n\n      let width = 0;\n\n      for(let i = this.selectMinColIndex; i <= this.selectMaxColIndex; i++) {\n        width += minRow.cells[i].width;\n      }\n\n      let height = 0;\n\n      for(let i = this.selectMinRowIndex; i <= this.selectMaxRowIndex; i++) {\n        height += this.rows[i].height;\n      }\n\n      this.context.drawRect(x, y, width, height, {\n        borderColor: 'blue',\n        borderWidth: 2\n      });\n    }\n  }\n\n  resizeRow(rowIndex, delta) {\n    this.rows[rowIndex].height += delta;\n\n    for(let i = rowIndex + 1; i < this.rows.length; i++) {\n      this.rows[i].y += delta;\n    }\n  }\n\n  resizeCol(colIndex, newWidth) {\n    if(newWidth < 0) {\n      return;\n    }\n    \n    this.columnHeaderRow.resizeCol(colIndex, newWidth);\n\n    for(let i = 0; i < this.rows.length; i++) {\n      this.rows[i].resizeCol(colIndex, newWidth);\n    }\n  }\n\n  deselectAllCells() {\n    for(let i = 0; i < this.rows.length; i++) {\n      this.rows[i].deselectAllCells();\n    }\n  }\n\n  startMultiSelect() {\n    this.clearMultiSelect();\n    this.isMultiSelecting = true;\n    this.showMultiSelect = true;\n  }\n\n  endMultiSelect() {\n    this.isMultiSelecting = false;\n  }\n\n  clearMultiSelect() {\n    this.showMultiSelect = false;\n    this.selectMinRowIndex = -1;\n    this.selectMaxRowIndex = -1;\n    this.selectMinColIndex = -1;\n    this.selectMaxColIndex = -1;\n  }\n\n  multiSelectSize() {\n    return (this.selectMaxRowIndex - this.selectMinRowIndex + 1) * (this.selectMaxColIndex - this.selectMinColIndex + 1);\n  }\n\n  updateSelection(rowIndex, colIndex) {\n    if(this.isMultiSelecting) {\n      if(this.selectMinRowIndex == -1 || rowIndex < this.selectMinRowIndex) {\n        this.selectMinRowIndex = rowIndex;\n      }\n\n      if(this.selectMaxRowIndex == -1 || rowIndex > this.selectMaxRowIndex) {\n        this.selectMaxRowIndex = rowIndex;\n      }\n\n      if(this.selectMinColIndex == -1 || colIndex < this.selectMinColIndex) {\n        this.selectMinColIndex = colIndex;\n      }\n\n      if(this.selectMaxColIndex == -1 || colIndex > this.selectMaxColIndex) {\n        this.selectMaxColIndex = colIndex;\n      }\n\n      this.deselectAllCells();\n\n      for(let i = this.selectMinRowIndex; i <= this.selectMaxRowIndex; i++) {\n        this.rows[i].updateSelection(this.selectMinColIndex, this.selectMaxColIndex);\n      }\n    }\n  }\n\n  getCell(rowIndex, colIndex) {\n    return this.rows[rowIndex].getCell(colIndex);\n  }\n}\n\nexport default {\n  Sheet: Sheet\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/Sheet.js\n **/","\nclass Context {\n  constructor(target, options) {\n    options = Object.assign({\n      onMouseMove: (x, y) => {},\n      onMouseDown: (x, y) => {},\n      onMouseUp: (x, y) => {},\n      onMouseClick: (x, y) => {},\n      onScroll: (dx, dy) => {}\n    }, options);\n\n    target.width = options.width * 2;\n    target.height = options.height * 2;\n    target.style.width = options.width + \"px\";\n    target.style.height = options.height + \"px\";\n\n    this.ctx = target.getContext(\"2d\");\n    this.ctx.scale(2, 2);\n\n    var self = this;\n\n    const getMouseCoords = function (e) {\n  \t\tvar rect = self.ctx.canvas.getBoundingClientRect();\n\n  \t\treturn {\n  \t\t\tx: e.clientX - rect.left,\n  \t\t\ty: e.clientY - rect.top\n  \t\t};\n  \t};\n\n    this.ctx.canvas.onmousemove = function(e) {\n      var coords = getMouseCoords(e);\n    \toptions.onMouseMove(coords.x, coords.y);\n      e.preventDefault();\n    };\n\n    this.ctx.canvas.onmousedown = function (e) {\n    \tvar coords = getMouseCoords(e);\n    \toptions.onMouseDown(coords.x, coords.y);\n      e.preventDefault();\n    };\n\n    this.ctx.canvas.onmouseup = function (e) {\n    \tvar coords = getMouseCoords(e);\n    \toptions.onMouseUp(coords.x, coords.y);\n      e.preventDefault();\n    };\n\n    this.ctx.canvas.onclick = function (e) {\n    \tvar coords = getMouseCoords(e);\n    \toptions.onMouseClick(coords.x, coords.y);\n      e.preventDefault();\n    };\n\n    this.ctx.canvas.onmousewheel = function(e) {\n      options.onScroll(e.deltaX, e.deltaY);\n      e.preventDefault();\n    };\n\n    // this.textBufferCanvas = document.createElement('canvas');\n    // this.textBufferContext = this.textBufferCanvas.getContext('2d');\n  }\n\n  drawLine(points, options) {\n    options = Object.assign({\n      width: 1,\n      color: 'black',\n      cap: 'square',\n      lineJoin: 'miter'\n    }, options);\n\n    this.ctx.beginPath();\n    this.ctx.moveTo(points[0][0], points[0][1]);\n    for(let i = 1; i < points.length; i++) {\n      this.ctx.lineTo(points[i][0], points[i][1]);\n    }\n    this.ctx.lineWidth = options.width;\n    this.ctx.strokeStyle = options.color;\n    this.ctx.lineCap = options.cap;\n    this.ctx.lineJoin = options.lineJoin;\n    this.ctx.stroke();\n  }\n\n  drawRect(x, y, width, height, options) {\n    options = Object.assign({\n      borderWidth: 1,\n      borderColor: undefined,\n      fillColor: undefined\n    }, options);\n\n    this.ctx.beginPath();\n\n    if(options.fillColor) {\n      this.ctx.fillStyle = options.fillColor;\n    }\n\n    if(options.borderColor) {\n      this.ctx.lineWidth = options.borderWidth;\n      this.ctx.strokeStyle = options.borderColor;\n    }\n\n    this.ctx.rect(x, y, width, height);\n\n    if(options.fillColor) {\n      this.ctx.fill();\n    }\n\n    if(options.borderColor) {\n      this.ctx.stroke();\n    }\n  }\n\n  drawText(text, x, y, options) {\n    options = Object.assign({\n      font: '14px Sans',\n      color: 'white',\n      align: 'center',\n      baseLine: 'middle'\n    }, options);\n\n    this.ctx.font = options.font;\n    this.ctx.fillStyle = options.color;\n    this.ctx.textAlign = options.align;\n    this.ctx.textBaseline = options.baseLine;\n\n    this.ctx.fillText(text, x, y);\n  }\n\n  drawImage(img, x, y, width, height) {\n    this.ctx.drawImage(img, x, y, width, height);\n  }\n\n  clear() {\n    this.ctx.clearRect(0, 0, this.ctx.canvas.width, this.ctx.canvas.height);\n  }\n}\n\nexport default Context;\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/Context.js\n **/","import ScreenComponent from './ScreenComponent';\nimport RowHeader from './RowHeader';\nimport Cell from './Cell';\nimport {CELL_WIDTH, CELL_HEIGHT, ROW_HEADER_WIDTH} from './constants';\n\nclass Row extends ScreenComponent {\n  constructor(index, sheet, x, y, colCount, options) {\n    //TODO: Calculate width, also update width on column resize\n    //TODO: Pass in width and height as options\n    super(sheet, x, y, ROW_HEADER_WIDTH + colCount * CELL_WIDTH, CELL_HEIGHT);\n\n    this.index = index;\n\n    //Header cell\n    this.rowHeader = new RowHeader(0, index, sheet, 0, this.y, ROW_HEADER_WIDTH, CELL_HEIGHT, {\n      color: 'black',\n      backGroundColor: 'lightGray',\n      borderColor: 'black',\n      borderWidth: 1\n    });\n\n    //Data cells\n    this.cells = [];\n\n    let cellX = ROW_HEADER_WIDTH;\n\n    for(let i = 0; i < colCount; i++) {\n      this.cells.push(new Cell(i, index, sheet, cellX, this.y, CELL_WIDTH, CELL_HEIGHT, options));\n      cellX += CELL_WIDTH;\n    }\n  }\n\n  draw() {\n    for(let i = 0; i < this.cells.length; i++) {\n      const cell = this.cells[i];\n\n      if(cell.isVisibleOnScreen()) {\n        cell.draw();\n      }\n    }\n\n    this.rowHeader.draw();\n  }\n\n  resizeCol(colIndex, newWidth) {\n    let cell = this.cells[colIndex]\n    let oldWidth = cell.width;\n\n    cell.width = newWidth;\n    cell.repaint();\n\n    for(let i = colIndex + 1; i < this.cells.length; i++) {\n      this.cells[i].x += (newWidth - oldWidth);\n    }\n  }\n\n  mouseDown(x, y) {\n    for(let i = 0; i < this.cells.length; i++) {\n      if(this.cells[i].isCollision(x, y)) {\n        this.cells[i].mouseDown(x, y);\n      }\n    }\n  }\n\n  mouseMove(x, y) {\n    for(let i = 0; i < this.cells.length; i++) {\n      if(this.cells[i].isCollision(x, y)) {\n        this.cells[i].mouseMove(x, y);\n      }\n    }\n  }\n\n  mouseUp(x, y) {\n    for(let i = 0; i < this.cells.length; i++) {\n      if(this.cells[i].isCollision(x, y)) {\n        this.cells[i].mouseUp(x, y);\n      }\n    }\n  }\n\n  mouseClick(x, y) {\n    for(let i = 0; i < this.cells.length; i++) {\n      if(this.cells[i].isCollision(x, y)) {\n        this.cells[i].mouseClick(x, y);\n      }\n    }\n  }\n\n  deselectAllCells() {\n    for(let i = 0; i < this.cells.length; i++) {\n      this.cells[i].blur();\n    }\n  }\n\n  updateSelection(minColIndex, maxColIndex) {\n    for(let i = minColIndex; i <= maxColIndex; i++) {\n      this.cells[i].isSelected = true;\n    }\n  }\n\n  getCell(colIndex) {\n    return this.cells[colIndex];\n  }\n}\n\nexport default Row;\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/Row.js\n **/","class ScreenComponent {\n  constructor(sheet, x, y, width, height) {\n    this.sheet = sheet;\n    this.x = x;\n    this.y = y;\n    this.width = width;\n    this.height = height;\n  }\n\n  draw() {\n    // console.log(\"ScreenComponent:draw()\");\n  }\n\n  isVisibleOnScreen() {\n    return !(this.x + this.sheet.scrollX + this.width < 0 || this.x + this.sheet.scrollX > this.sheet.width ||\n      this.y + this.sheet.scrollY + this.height < 0 || this.y + this.sheet.scrollY > this.sheet.height);\n  }\n\n  isCollision(canvasX, canvasY) {\n    return canvasX > this.x + this.sheet.scrollX &&\n      canvasX < this.x + this.sheet.scrollX + this.width &&\n      canvasY > this.y + this.sheet.scrollY &&\n      canvasY < this.y + this.sheet.scrollY + this.height;\n  }\n}\n\nexport default ScreenComponent;\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/ScreenComponent.js\n **/","import ScreenComponent from './ScreenComponent';\n\nclass RowHeader extends ScreenComponent {\n  constructor(index, rowIndex, sheet, x, y, width, height, options) {\n    super(sheet, x, y, width, height, options);\n\n    this.rowIndex = rowIndex;\n\n    Object.assign(this, {\n      color: 'black',\n      backGroundColor: 'lightGray',\n      borderColor: 'darkGray',\n      borderWidth: 1\n    }, options);\n\n    this.textBufferCanvas = document.createElement('canvas');\n    this.textBufferContext = this.textBufferCanvas.getContext('2d');\n\n    this.textBufferCanvas.width = this.width * 2;\n    this.textBufferCanvas.height = this.height * 2;\n    this.textBufferCanvas.style.width = this.width;\n    this.textBufferCanvas.style.height = this.height;\n\n    this.textBufferContext.scale(2, 2);\n\n    this.textBufferContext.font = this.height * 0.8  + 'px Sans';\n    this.textBufferContext.fillStyle = this.color;\n    this.textBufferContext.textAlign = 'center';\n    this.textBufferContext.textBaseline = 'middle';\n\n    this.updateText(rowIndex + 1);\n  }\n\n  updateText(text) {\n    this.text = text;\n    this.textBufferContext.fillText(this.text, this.width / 2, this.height / 2);\n  }\n\n  draw() {\n    this.sheet.context.drawRect(this.x, this.sheet.scrollY + this.y, this.width, this.height, {\n      fillColor: this.backGroundColor,\n      borderColor: this.borderColor,\n      borderWidth: this.borderWidth\n    });\n\n    this.sheet.context.drawImage(this.textBufferCanvas, this.x, this.y + this.sheet.scrollY, this.width, this.height);\n  }\n}\n\nexport default RowHeader;\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/RowHeader.js\n **/","import ScreenComponent from './ScreenComponent';\nimport Context from './Context';\nimport {ROW_HEADER_WIDTH} from './constants';\nimport {aToI} from './util';\n\nclass Cell extends ScreenComponent {\n  constructor(index, rowIndex, sheet, x, y, width, height, options) {\n    super(sheet, x, y, width, height);\n\n    this.index = index;\n    this.rowIndex = rowIndex;\n    this.text = \"\";\n\n    Object.assign(this, {\n      color: 'black',\n      backGroundColor: 'white',\n      borderColor: 'darkGray',\n      borderWidth: 1\n    }, options);\n\n    this.dependentCells = [];\n  }\n\n  registerDependentValueCell(cell) {\n    this.dependentCells.push(cell);\n  }\n\n  updateValue(value) {\n    this.value = value;\n\n    //TODO: Should nulls be displayed the same as undefined (i.e. blank)?\n    if(value === undefined || value === null) {\n      return;\n    }\n\n    const getIndividualArgValue = (arg) => {\n      // let colAlphaMatch = arg.match(/[A-Z]+/);\n\n      if(/[A-Z]+/.test(arg)) {\n        //Cell reference\n        let colAlpha = colAlphaMatch[0];\n        let col = aToI(colAlpha);\n        let row = arg.match(/\\d+/)[0] - 1;\n\n        let cell = this.sheet.getCell(row, col);\n\n        return cell.value;\n      }\n      else {\n        //Number literal (we assume)\n        return arg;\n      }\n    };\n\n    if(value.indexOf(\"=\") == 0) {\n      let functionName = value.substr(1).split('(')[0];\n      let args = value.substr(1).split('(')[1].replace(')', '').split(',');\n\n      let argValues = [];\n\n      for(let i = 0; i < args.length; i++) {\n        let arg = args[i].trim();\n\n        if(arg.indexOf(\":\") !== -1) {\n          let rangeIndexes = arg.split(':');\n\n          //TODO: This is not actually a range right now\n          for(let j = 0; j < rangeIndexes.length; j++) {\n            argValues.push(getIndividualArgValue(rangeIndexes[j]));\n          }\n        }\n        else {\n          argValues.push(getIndividualArgValue(arg));\n        }\n      }\n\n      let result = formulajs[functionName].apply(null, argValues);\n\n      this.text = result;\n    }\n    else {\n      this.text = value;\n    }\n\n    if(!this.isTextBufferInitialized) {\n      this.textBufferCanvas = document.createElement('canvas');\n\n      this.textBufferContext = new Context(this.textBufferCanvas, {\n        width: this.width,\n        height: this.height\n      });\n\n      this.isTextBufferInitialized = true;\n    }\n\n    this.isNumeric = this.text && /^\\d*(\\.\\d+)?$/.test(this.text);\n\n    this.repaint();\n  }\n\n  repaint() {\n    if(this.isTextBufferInitialized) {\n      this.textBufferContext = new Context(this.textBufferCanvas, {\n        width: this.width,\n        height: this.height\n      });\n\n      this.textBufferContext.clear();\n\n      this.textBufferContext.drawRect(0, 0, this.width, this.height, {\n        fillColor: this.isSelected ? '#c9e2f9' : this.backGroundColor,\n        borderColor: this.borderColor,\n        borderWidth: this.borderWidth\n      });\n\n      //TODO: Formatting\n\n      this.textBufferContext.drawText(this.text, this.isNumeric ? this.width : 0, this.height / 2, {\n        font: this.height * 0.8 + 'px Sans',\n        color: this.color,\n        align: this.isNumeric ? 'end' : 'start',\n        baseLine: 'middle'\n      });\n    }\n\n    if(this.isEditing) {\n      if(this.width > 4) {\n        this.inputElement.width(this.width - 4);\n      }\n      else {\n        this.blur();\n      }\n    }\n  }\n\n  draw() {\n    if(!this.isTextBufferInitialized) {\n      this.sheet.context.drawRect(this.sheet.scrollX + this.x, this.sheet.scrollY + this.y, this.width, this.height, {\n        fillColor: this.isSelected ? '#c9e2f9' : this.backGroundColor,\n        borderColor: this.borderColor,\n        borderWidth: this.borderWidth\n      });\n    }\n    else {\n      this.sheet.context.drawImage(this.textBufferCanvas, this.x + this.sheet.scrollX, this.y + this.sheet.scrollY, this.width, this.height);\n    }\n\n    if(this.isEditing) {\n      if(this.sheet.scrollX + this.x < ROW_HEADER_WIDTH || this.sheet.scrollX + this.x > this.sheet.width - this.width || this.sheet.scrollY + this.y < 20 || this.sheet.scrollY + this.y > this.sheet.height - this.height) {\n        this.inputElement.hide();\n      }\n      else {\n        this.inputElement.show();\n        this.inputElement.css(\"left\", this.sheet.scrollX + this.x + \"px\");\n        this.inputElement.css(\"top\", this.sheet.scrollY + this.y + \"px\");\n        this.inputElement.focus();\n      }\n    }\n  }\n\n  blur() {\n    this.isSelected = false;\n\n    if(this.isEditing) {\n      this.isEditing = false;\n      this.updateValue(this.inputElement.val());\n      this.inputElement.remove();\n      this.inputElement = undefined;\n    }\n  }\n\n  mouseDown(x, y) {\n    this.sheet.startMultiSelect();\n    this.sheet.updateSelection(this.rowIndex, this.index);\n  }\n\n  mouseMove(x, y) {\n    if(this.sheet.isMultiSelecting) {\n      this.sheet.updateSelection(this.rowIndex, this.index);\n    }\n  }\n\n  mouseUp(x, y) {\n    if(this.sheet.multiSelectSize() == 1) {\n      this.edit();\n      this.sheet.clearMultiSelect();\n    }\n\n    this.sheet.endMultiSelect();\n  }\n\n  mouseClick(x, y) {\n\n  }\n\n  edit() {\n    this.sheet.deselectAllCells();\n\n    this.isEditing = true;\n    this.inputElement = $(\"<input>\", {\n      type: \"text\",\n      id: \"cell-input\",\n      style:\n        \"text-align: \" + (this.isNumeric ? \"right\" : \"left\") + \";\" +\n        \"position: fixed;\" +\n        \"left: \" + this.sheet.scrollX + this.x + \"px;\" +\n        \"top: \" + this.sheet.scrollY + this.y + \"px;\" +\n        \"width: \" + (this.width - 4) + \"px; height: \" + (this.height - 4) + \"px;\"\n    });\n\n    $(\"body\").append(this.inputElement);\n\n    let dirty = false;\n\n    this.inputElement.val(this.value);\n\n    this.inputElement.keydown((e) => {\n      let keyCode = e.keyCode || e.which;\n\n      //TODO: auto scroll if moving to cell would make the input disappear\n\n      if(keyCode === 13) {\n        //Enter, go to next row\n        this.sheet.rows[this.rowIndex + (e.shiftKey ? -1 : 1)].cells[this.index].edit();\n      }\n      else if(keyCode === 9) {\n        //Tab, go to next column\n        this.sheet.rows[this.rowIndex].cells[this.index + (e.shiftKey ? -1 : 1)].edit();\n        e.preventDefault();\n      }\n      else if(keyCode === 37) {\n        //Left arrow\n        if(!dirty) {\n          this.sheet.rows[this.rowIndex].cells[this.index - 1].edit();\n        }\n      }\n      else if(keyCode === 39) {\n        //Right arrow\n        if(!dirty) {\n          this.sheet.rows[this.rowIndex].cells[this.index + 1].edit();\n        }\n      }\n      else if(keyCode === 38) {\n        //Up arrow\n        this.sheet.rows[this.rowIndex - 1].cells[this.index].edit();\n      }\n      else if(keyCode === 40) {\n        //Down arrow\n        this.sheet.rows[this.rowIndex + 1].cells[this.index].edit();\n      }\n      else if((keyCode === 46 /* Delete */ || keyCode === 8 /* Backspace */) && !dirty) {\n        this.inputElement.val(undefined);\n        this.updateValue(undefined);\n      }\n    });\n\n    this.inputElement.keyup((e) => {\n      let keyCode = e.keyCode || e.which;\n\n      if(keyCode !== 13 && keyCode !== 9 && keyCode !== 37 && keyCode !== 39 && keyCode !== 38 && keyCode !== 40) {\n        dirty = true;\n\n        this.updateValue(this.inputElement.val());\n\n        if(this.isNumeric) {\n          this.inputElement.css(\"text-align\", this.isNumeric ? \"right\" : \"left\")\n        }\n      }\n    });\n\n    this.inputElement.bind('paste', (e) => {\n      var pastedData = e.originalEvent.clipboardData.getData('text');\n\n    });\n\n    this.inputElement.focus();\n  }\n}\n\nexport default Cell;\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/Cell.js\n **/","export const ROW_HEADER_WIDTH = 40;\nexport const CELL_WIDTH = 70;\nexport const CELL_HEIGHT = 20;\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/constants.js\n **/","const alpha = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\"; //0 = A, 25 = Z\n\nexport const iToA = (i) => {\n  let current = i;\n\n  let a = \"\";\n\n  while(current > -1) {\n    let digit = current % 26;\n    a = alpha[digit] + \"\" + a;\n\n    //This is not a straight number base conversion, we need to\n    //treat A as\n    current = Math.floor(current / 26) - 1;\n  }\n\n  return a;\n}\n\nexport const aToI = (a) => {\n  let index = (alpha.indexOf(a[0]) + 1) * Math.pow(26, a.length - 1) - 1;\n\n  for(let i = a.length - 1; i > 0; i--) {\n    index += (alpha.indexOf(a[i]) + 1) * Math.pow(26, a.length - i - 1);\n  }\n\n  return index;\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/util.js\n **/","import ScreenComponent from './ScreenComponent';\nimport ColumnHeader from './ColumnHeader';\nimport {CELL_WIDTH, CELL_HEIGHT, ROW_HEADER_WIDTH} from './constants';\n\nclass ColumnHeaderRow extends ScreenComponent {\n  constructor(sheet, x, y, colCount, options) {\n    super(sheet, x, y, ROW_HEADER_WIDTH + colCount * CELL_WIDTH, CELL_HEIGHT);\n\n    this.columnHeaders = [];\n\n    let headerX = ROW_HEADER_WIDTH;\n\n    for(let i = 0; i < colCount; i++) {\n      this.columnHeaders.push(new ColumnHeader(i, sheet, headerX, this.y, CELL_WIDTH, CELL_HEIGHT, {\n        color: 'black',\n        backGroundColor: 'lightGray',\n        borderColor: 'black',\n        borderWidth: 1\n      }));\n\n      headerX += CELL_WIDTH;\n    }\n  }\n\n  draw() {\n    for(let i = 0; i < this.columnHeaders.length; i++) {\n      const columnHeader = this.columnHeaders[i];\n\n      if(columnHeader.isVisibleOnScreen()) {\n        columnHeader.draw();\n      }\n    }\n  }\n\n  resizeCol(colIndex, newWidth) {\n    let columnHeader = this.columnHeaders[colIndex];\n    let oldWidth = columnHeader.width;\n\n    columnHeader.width = newWidth;\n    columnHeader.repaint();\n\n    for(let i = colIndex + 1; i < this.columnHeaders.length; i++) {\n      this.columnHeaders[i].x += (newWidth - oldWidth);\n    }\n  }\n\n  mouseMove(x, y) {\n    if(this.isResizing) {\n      let xDelta = x - this.resizeStartX;\n\n      this.sheet.resizeCol(this.resizeHeader.index, this.resizeStartWidth + xDelta);\n    }\n    else {\n      for(let i = 0; i < this.columnHeaders.length; i++) {\n        let columnHeader = this.columnHeaders[i];\n\n        if(x > columnHeader.x + this.sheet.scrollX + columnHeader.width - 5 && x < columnHeader.x + this.sheet.scrollX + columnHeader.width + 5) {\n          document.body.style.cursor = 'col-resize';\n          this.resizeHeader = columnHeader;\n        }\n      }\n    }\n  }\n\n  mouseDown(x, y) {\n    if(this.resizeHeader) {\n      this.resizeStartX = x;\n      this.resizeStartWidth = this.resizeHeader.width;\n      this.isResizing = true;\n    }\n  }\n\n  mouseUp(x, y) {\n    this.resizeHeader = undefined;\n    this.isResizing = false;\n  }\n\n  mouseClick(x, y) {\n    for(let i = 0; i < this.columnHeaders.length; i++) {\n      if(this.columnHeaders[i].isCollision(x, y)) {\n        this.columnHeaders[i].mouseClick(x, y);\n      }\n    }\n  }\n}\n\nexport default ColumnHeaderRow;\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/ColumnHeaderRow.js\n **/","import ScreenComponent from './ScreenComponent';\nimport {iToA} from './util';\n\nclass ColumnHeader extends ScreenComponent {\n  constructor(index, sheet, x, y, width, height, options) {\n    super(sheet, x, y, width, height, options);\n\n    this.index = index;\n\n    Object.assign(this, {\n      color: 'black',\n      backGroundColor: 'lightGray',\n      borderColor: 'darkGray',\n      borderWidth: 1\n    }, options);\n\n    this.updateText(iToA(this.index));\n  }\n\n  isVisibleOnScreen() {\n    return !(this.x + this.sheet.scrollX + this.width < 0 || this.x + this.sheet.scrollX > this.sheet.width ||\n      this.y + this.height < 0 || this.y  > this.sheet.height);\n  }\n\n  updateText(value) {\n    this.text = value;\n\n    this.repaint();\n  }\n\n  repaint() {\n    this.textBufferCanvas = document.createElement('canvas');\n    this.textBufferContext = this.textBufferCanvas.getContext('2d');\n\n    this.textBufferCanvas.width = this.width * 2;\n    this.textBufferCanvas.height = this.height * 2;\n    this.textBufferCanvas.style.width = this.width;\n    this.textBufferCanvas.style.height = this.height;\n\n    this.textBufferContext.scale(2, 2);\n\n    this.textBufferContext.font = this.height * 0.8 + 'px Sans';\n    this.textBufferContext.fillStyle = this.color;\n    this.textBufferContext.textAlign = 'center';\n    this.textBufferContext.textBaseline = 'middle';\n\n    this.textBufferContext.fillText(this.text, this.width / 2, this.height / 2);\n  }\n\n  draw() {\n    this.sheet.context.drawRect(this.x + this.sheet.scrollX, this.y, this.width, this.height, {\n      fillColor: this.backGroundColor,\n      borderColor: this.borderColor,\n      borderWidth: this.borderWidth\n    });\n\n    this.sheet.context.drawImage(this.textBufferCanvas, this.x + this.sheet.scrollX, this.y, this.width, this.height);\n  }\n}\n\nexport default ColumnHeader;\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/ColumnHeader.js\n **/"],"sourceRoot":""}